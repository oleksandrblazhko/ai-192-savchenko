# V9.2 Безпека зв'язку з сервером

Зв’язок із сервером — це більше, ніж просто HTTP. Захищені з’єднання з іншими системами, наприклад системи моніторингу, інструменти управління, віддалений доступ і SSH, проміжне програмне забезпечення, база даних, мейнфрейми, зовнішні системні джерела — повинні бути на місці. Усе це має бути зашифровано, щоб запобігти проблеми "жорсткий ззовні, дуже легко перехоплюваний всередині».

**9.2.1** Перевірте, чи підключення до сервера та з нього використовують надійні сертифікати TLS. Якщо використовуються внутрішньо згенеровані або самопідписані сертифікати, сервер має бути налаштовано на довіру лише певним внутрішнім центрам сертифікації ключів і певним самопідписаним сертифікатам. Всі інші повинні бути відкинуті. (CWE 295)

**9.2.2** Переконайтеся, що зашифрований зв’язок, такий як TLS, використовується для всіх вхідних і вихідних з'єднань, в тому числі для портів управління, моніторингу, автентифікації, API або викликів веб-служб, баз даних, хмарних, безсерверних застосунків, мейнфреймів, зовнішніх та партнерських підключень. Сервер не повинен повертатися до незахищених або незашифрованих протоколів. (CWE 319)

**9.2.3** Переконайтеся, що всі зашифровані підключення до зовнішніх систем, які включають конфіденційну інформація або функції, автентифіковані. (CWE 287)

**9.2.4** Перевірте правильність відкликання сертифіката, як-от зшивання протоколу статусу онлайн-сертифіката,), увімкнено та налаштовано. (CWE 299)

**9.2.5** Перевірте, чи реєструються збої підключення TLS. (CWE 544)

## CWE 295
### Опис
Продукт не перевіряє або неправильно перевіряє сертифікат.

### Розширений опис
Якщо сертифікат недійсний або зловмисний, він може дозволити зловмиснику підробити довірену сутність, втручаючись у шлях зв’язку між хостом і клієнтом. Продукт може підключитися до зловмисного хосту, вважаючи, що він є надійним хостом, або продукт може бути введений в оману для прийняття підроблених даних, які, здається, походять від надійного хосту.

### Платформи
Мови</br>
Клас: не залежить від мови (поширеність не визначена)

Технології</br>
Клас: мобільний (поширеність не визначена)

### Поширені наслідки
Розділи: цілісність, аутентифікація</br>
Технічний вплив: обходження захисного механізму; отримання привілей або присвоєння ідентифікації

## CWE 319
### Опис
Продукт передає конфіденційні або важливі для безпеки дані у вигляді відкритого тексту по каналу зв’язку, який можуть контролювати неавторизовані особи.
### Розширений опис
Зловмисники під час передачі даних можуть контролювати багато каналів зв’язку. Наприклад, у мережах пакети можуть проходити через багато проміжних вузлів від джерела до місця призначення через Інтернет, внутрішню мережу, хмару тощо. Деякі учасники можуть мати привілейований доступ до мережевого інтерфейсу або будь-якого зв’язку вздовж каналу, наприклад маршрутизатор, але вони можуть бути не авторизовані для збору основних даних. У результаті зловмисники можуть перехопити мережевий трафік, розповсюджуючи критично важливі для безпеки дані.

Застосовні канали зв'язку не обмежуються програмними продуктами. Застосовні канали включають спеціальні апаратні технології, такі як внутрішні апаратні мережі та зовнішні канали налагодження, що підтримують віддалене налагодження JTAG (Joint Test Action Group - Спільна група випробувань). Якщо засоби пом’якшення не застосовуються для боротьби з супротивниками в рамках моделі загрози продукту, ця слабкість значно знижує складність експлуатації такими супротивниками.

Коли повне спілкування записується або реєструється, зловмисник може спробувати отримати пакет через довгий час після того, як відбулася передача, і спробувати контролювати відкритий текст із записаного зв’язку. Навіть якщо інформація закодована у спосіб, який не читається людиною, певні методи можуть визначити, яке кодування використовується, а потім декодувати інформацію.

### Платформи
Мови</br>
Клас: не залежить від мови (поширеність не визначена)

Технології</br>
Клас: хмарні обчислення (поширеність не визначена)</br>
Клас: мобільний (поширеність не визначена)</br>
Клас: ICS/OT (часто поширене)</br>
Клас: система на кристалі (поширеність не визначена)</br>
Тестування/налагодження обладнання (часто поширене)</br>

### Поширені наслідки
Розділи: цілісність, конфіденційність</br>
Технічний вплив: читання даних програми; зміна файлів або каталогів

Будь-хто може прочитати інформацію, отримавши доступ до каналу, який використовується для спілкування.

### Ймовірність експлойту
Висока

## CWE 287
#### Опис
Коли ектор стверджує, що має певну особу, продукт не доводить або недостатньо доводить, що твердження правильне.

### Платформи
Мови</br>
Клас: не залежить від мови (поширеність не визначена)

Технології</br>
Клас: ICS/OT (часто поширене)

### Поширені наслідки
Розділи: цілісність, конфіденційність, доступність, управління доступом</br>
Технічний вплив: читання даних програми; отримання привілей або отримання ідентифікації; виконання несанкціонованого коду або команд

Ця слабкість може призвести до того, що ресурси або функції стануть доступними для ненавмисних суб’єктів, що, можливо, надасть зловмисникам конфіденційну інформацію або навіть запустить довільний код.
### Ймовірність експлойту
Висока

## CWE 299
### Опис
Продукт не перевіряє або неправильно перевіряє статус відкликання сертифіката, що може призвести до використання сертифіката, який було скомпрометовано.
### Розширений опис
Неналежна перевірка на відкликання сертифіката є набагато серйознішою вадою, ніж відповідні збої сертифікатів. Це пояснюється тим, що використання будь-якого відкликаного сертифіката майже напевно є зловмисним. Найпоширенішою причиною відкликання сертифіката є компрометація відповідної системи, в результаті чого жоден законний сервер не використовуватиме відкликаний сертифікат, якщо тільки вони не несинхронізовані.

### Платформи
Мови</br>
Клас: не залежить від мови (поширеність не визначена)

### Поширені наслідки
Розділи: управління доступом</br>
Технічний вплив: отримання привілей або присвоєння ідентифікації</br>
Довіра може бути призначена суб’єкту, який не є тим, за кого себе видає.

Розділи: цілісність, інші</br>
Технічний вплив: інше</br>
Можуть бути інтегровані дані з ненадійного (і, можливо, шкідливого) джерела.

Розділи: конфіденційність</br>
Технічний вплив: читання даних програми</br>
Дані можуть бути розкриті організації, яка видає себе за довірену особу, що призведе до розкриття інформації.

### Ймовірність експлойту
Середня

## CWE 544
### Опис
У продукті не використовується стандартизований метод обробки помилок у всьому коді, що може спричинити неузгоджену обробку помилок і відповідні недоліки.
### Розширений опис
Якщо продукт обробляє повідомлення про помилки окремо, по одному, це може призвести до непослідовної обробки помилок. Причини помилок можуть бути втрачені. Крім того, детальна інформація про причини помилки може бути ненавмисно повернена користувачеві.

### Поширені наслідки
Розділи: цілісність, інші</br>
Технічний вплив: погіршення якості; неочікуваний стан; залежить від контексту